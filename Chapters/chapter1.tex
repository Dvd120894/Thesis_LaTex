\chapter{Computation Geometry Algorithms}
\label{Geom_Algos}
%
\section{Ray-Triangle Intersection Algorithm}
One of the many problems in Computer Graphics is the ray-triangle intersection.
%
\subsection{The M\"oller-Trumbore Algorithm}
%
The inputs of the  M\"oller-Trumbore algorithm are:
\begin{itemize}
	\item Triangle vertices $(V_1, V_2, V_3)$;
	\item Segment points $(Q_1, Q_2)$.
\end{itemize}
%
\noindent
\begin{minipage}[t]{.5\textwidth}
\raggedright
\textit{With Back-Face Culling}\\
\vspace{1em}
$Q = Q_2 - Q_1$\\
$E_1 = V_2 - V_1$\\
$E_2 = V_3 - V_1$\\
$A = Q \times E_2$\\
$D = A \cdot E_1$\\
$\mathbf{if} \, (D > \varepsilon) \{$\\
\quad $T = Q_1 - V_1$\\
\quad $u = A \cdot T$\\
\quad $\mathbf{if} \, (u < 0.0 \, || \, u > D) \{$\\
\quad \quad $\mathbf{return \, false}$\\
\quad $\}$\\
\quad $B = T \times E_1$\\
\quad $v = B \cdot Q$\\
\quad $\mathbf{if} \, (v < 0.0 \, || \, u + v > D) \{$\\
\quad \quad $\mathbf{return \, false}$\\
\quad $\}$\\
$\} \, \mathbf{else \, if} \, (D < -\varepsilon) \{$\\
\quad $T = Q_1 - V_1$\\
\quad $u = A \cdot T$\\
\quad $\mathbf{if} \, (u > 0.0 \, || \, u < D) \{$\\
\quad \quad $\mathbf{return \, false}$\\
\quad $\}$\\
\quad $B = T \times E_1$\\
\quad $v = B \cdot Q$\\
\quad $\mathbf{if} \, (v > 0.0 \, || \, u + v < D) \{$\\
\quad \quad $\mathbf{return \, false}$\\
\quad $\}$\\
$\} \, \mathbf{else} \, \{$\\
\quad $\mathbf{return \, false}$\\
$\}$\\
$D_{inv} = 1.0 / D$\\
$t = (B \cdot E_2) * D_{inv}$\\
$\mathbf{if} \, (t > 0.0) \{$\\
\quad $P = Q + D * t$\\
\quad $\mathbf{return \, true}$\\
$\} \, \mathbf{else} \, \{$\\
\quad $\mathbf{return \, false}$\\
$\}$
\end{minipage}% <---------------- Note the use of "%"
\begin{minipage}[t]{.5\textwidth}
\raggedright
\textit{Without Back-Face Culling}\\
\vspace{1em}
$Q = Q_2 - Q_1$\\
$E_1 = V_2 - V_1$\\
$E_2 = V_3 - V_1$\\
$A = Q \times E_2$\\
$D = A \cdot E_1$\\
$\mathbf{if} \, (D < \varepsilon) \{$\\
\quad $\mathbf{return \, false}$\\
$\}$\\
$T = Q_1 - V_1$\\
$u = A \cdot T$\\
$\mathbf{if} \, (u < 0.0 \, || \, u > D) \{$\\
\quad $\mathbf{return \, false}$\\
$\}$\\
$B = T \times E_1$\\
$v = B \cdot Q$\\
$\mathbf{if} \, (v < 0.0 \, || \, u + v > D) \{$\\
\quad \quad $\mathbf{return \, false}$\\
$\}$\\
$D_{inv} = 1.0 / D$\\
$t = (B \cdot E_2) * D_{inv}$\\
$\mathbf{if} \, (t > 0.0) \{$\\
\quad $P = Q + D * t$\\
\quad $\mathbf{return \, true}$\\
$\} \, \mathbf{else} \, \{$\\
\quad $\mathbf{return \, false}$\\
$\}$
\end{minipage}